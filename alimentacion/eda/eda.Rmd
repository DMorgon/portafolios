---
title: "Analisis Exploratorio de las hojas de volumen"
author: "David Moreno"
date: "2023-08-23"
output: pdf_document
---
## Introducción

En el marco del proyecto de análisis de datos, exploramos una colección de información que abarca dos décadas, desde el año 2000 hasta el 2022, sobre los hábitos de consumo de alimentos en los hogares españoles. 

Este conjunto de datos se presenta en forma de 22 archivos Excel, cada uno correspondiente a un año específico, alojados en un repositorio de GitHub.

Cada archivo contine 14 hojas, y una de las cuales es la información de "volumen", que mide la cantidad de alimentos consumidos por los hogares españoles.

A continuación me dispongo a realizar un Analisis Esploratorio de los datos (EDA en sus siglas en inglés), con el fin de entender mejor dicho conjunto dedatos, para mas adelante, poder valorar hacer un conjunto de datos más amplio, donde se puedan combinar otra información. 


## 1. Preparación del entorno de trabajo

Configuro el repositorio de CRAN de manera no interactiva

```{r}
options(repos = c(CRAN = "https://cran.r-project.org"))
```

Instalo las librerías que voy a utilizar

```{r}
install.packages("readxl")
install.packages("httr")
install.packages("tidyverse")
install.packages("rmarkdown")
install.packages("dplyr")
install.packages("ggplot2")
install.packages("scales")
install.packages("corrplot")
```

Y, por último, se cargan las librerías.

```{r}
library(readxl)
library(httr)
library(tidyverse)
library(rmarkdown)
library(dplyr)
library(ggplot2)
library(scales)
library(corrplot)
```

## 2. Obtención de los datos
### 2.1 Extración de los datos

```{r}

# Creo una lista vacía donde almacenaré los df.
lista_df_volumen <- list()

# Mediante un bucle for, recorro cada archivo, para extraer los datos
for (i in seq(from = 1, to = 23, by = 1)) {
  
  # Datos de la ruta
  ruta <- "https://github.com/DMorgon/portafolios/raw/main"
  rama <- "alimentacion/datos_origen"

  # Creo la ruta desde donde se descargaran los archivos
  archivo_url <- paste0(ruta, "/", rama, "/", i + 1999, ".xlsx")
  
  # Creo el nombre del archivo local
  archivo_local <- paste0(i, ".xlsx")
  
  # Descargar el archivo desde la URL
  response <- GET(archivo_url, write_disk(archivo_local, overwrite = TRUE))
  
  # Creo el df con los datos del archivo local
  df <- read_excel(archivo_local, sheet = 3, skip = 2)
  
  #Agrego el df a la lista de df.
  lista_df_volumen[[i]] <- df
  
  # Borro el archivo local
  file.remove(archivo_local)
}

# Elimino las variables que ya no se utilizará.
rm(ruta, rama, archivo_url, archivo_local, response, df, i)

```

### 2.2 Exploración inicial de los datos

```{r}

# Mediante un bucle for, imprimo la estructura inter de cada dataframe
for (i in seq(1, 23)) {
  
  # Imprimo el nombre de cada dataframe
  cat("Nombre de la tabla de datos: df_volumen_", i+1999, "\n")
  
  #Imprimo la estructura interna de cada dataframe
  cat(str(lista_df_volumen[[i]]), "\n")
}

# Elimino la variable i que no se utilizará
rm(i)
```
|Daraframe|Registros|Variables|
|---|---|--|
|df_volumen_2000|334|19|
|df_volumen_2001|334|19|
|df_volumen_2002|361|19|
|df_volumen_2003|361|19|
|df_volumen_2004|448|27|
|df_volumen_2005|465|27|
|df_volumen_2006|465|27|
|df_volumen_2007|552|27|
|df_volumen_2008|556|27|
|df_volumen_2009|556|27|
|df_volumen_2010|556|27|
|df_volumen_2011|556|27|
|df_volumen_2012|556|27|
|df_volumen_2013|580|27|
|df_volumen_2014|580|27|
|df_volumen_2015|580|27|
|df_volumen_2016|580|27|
|df_volumen_2017|580|27|
|df_volumen_2018|580|27|
|df_volumen_2019|686|19|
|df_volumen_2020|681|19|
|df_volumen_2021|681|19|
|df_volumen_2021|689|19|

Después de llevar a cabo una exploración inicial de la estructura interna de cada dataframe, se han identificado las siguientes conclusiones:

- Se han encontrado un total de 22 dataframes.

- Existe una disparidad en la cantidad de registros, es decir, en la variedad de alimentos, entre los distintos dataframes.

- Algunos dataframes contienen 19 variables, mientras que otros presentan 27. Esto se debe a que, en los dataframes correspondientes a los años de 2004 a 2018, se incorporaron 8 regiones adicionales.

- Se ha observado variabilidad en los nombres de las variables en algunos dataframes.

- También es posible que los nombres de los alimentos varíen de un dataframe a otro.

En consecuencia, las tareas que se llevarán a cabo a continuación son las siguientes:

- **Normalización de las variables**: Dado que existen diferencias en el número de variables y en sus nombres, se procederá a eliminar las 8 variables relacionadas con las regiones y a corregir el nombre de las variables restantes para asegurar consistencia.

- **Normalización de los registros**: Debido a la disparidad en la cantidad de alimentos registrados en diferentes años debido a cambios en la metodología, se realizará una selección de registros, priorizando las categorías de alimentos que representan las principales agrupaciones alimentarias. Esta metodología simplificará la complejidad de los datos, aunque conllevará la pérdida de algunos detalles específicos de los alimentos. Como resultado, los análisis se centrarán en identificar tendencias generales en lugar de detalles específicos de alimentos individuales. Posteriormente, se corregirán los nombres de los registros seleccionados para que sean consistentes en todos los dataframes.

- **Creación de un conjunto de datos consolidado**: Una vez normalizados los datos, se combinarán todos los dataframes en un conjunto consolidado, especificando además el año al que corresponde cada registro.

### 2.3 Transformación de los datos

Elimino las variables sobrantes

```{r}
for (i in seq(5, 19)) {
  if (i <= 13) {
    lista_df_volumen[[i]] <- lista_df_volumen[[i]][, !colnames(lista_df_volumen[[i]]) %in% c("T.ANDALUCIA", "CASTILLA LEON", "NORESTE", "LEVANTE", "CENTRO-SUR", "NOROESTE", "NORTE", "T.CANARIAS")]
  } 
  else {
    lista_df_volumen[[i]] <- lista_df_volumen[[i]][, !colnames(lista_df_volumen[[i]]) %in% c("ANDALUCÍA", "CASTILLA Y LEÓN", "NORESTE", "LEVANTE", "CENTRO-SUR", "NOROESTE", "NORTE", "T.CANARIAS")]
  }
}

# Elimino las variables en el environment que ya no utilizaré
rm(i)

```

A continuación corrijo el nombre de las variables para que todas sean iguales

```{r}
for (i in seq(1, 23)){
  colnames(lista_df_volumen[[i]])[colnames(lista_df_volumen[[i]]) == ".TOTAL ESPAÑA"] <- "ESPAÑA"  
  colnames(lista_df_volumen[[i]])[colnames(lista_df_volumen[[i]]) == "T.ESPAÑA"] <- "ESPAÑA"
  colnames(lista_df_volumen[[i]])[colnames(lista_df_volumen[[i]]) == "...1"] <- "CATEGORIAS"
  colnames(lista_df_volumen[[i]])[colnames(lista_df_volumen[[i]]) == "CASTILLA-LA MANCHA"] <- "CASTILLA LA MANCHA"
  colnames(lista_df_volumen[[i]])[colnames(lista_df_volumen[[i]]) == "RIOJA"] <- "LA RIOJA"
  colnames(lista_df_volumen[[i]])[colnames(lista_df_volumen[[i]]) == "ARAGÓN"] <- "ARAGON"
  colnames(lista_df_volumen[[i]])[colnames(lista_df_volumen[[i]]) == "ILLES BALEARS"] <- "BALEARES"
  colnames(lista_df_volumen[[i]])[colnames(lista_df_volumen[[i]]) == "COMUNITAT VALENCIANA"] <- "VALENCIA"
  colnames(lista_df_volumen[[i]])[colnames(lista_df_volumen[[i]]) == "REGIÓN DE MURCIA"] <- "MURCIA"
  colnames(lista_df_volumen[[i]])[colnames(lista_df_volumen[[i]]) == "ANDALUCÍA"] <- "ANDALUCIA"
  colnames(lista_df_volumen[[i]])[colnames(lista_df_volumen[[i]]) == "COMUNIDAD DE MADRID"] <- "MADRID"
  colnames(lista_df_volumen[[i]])[colnames(lista_df_volumen[[i]]) == "CASTILLA - LA MANCHA"] <- "CASTILLA LA MANCHA"
  colnames(lista_df_volumen[[i]])[colnames(lista_df_volumen[[i]]) == "CASTILLA Y LEÓN"] <- "CASTILLA Y LEON"
  colnames(lista_df_volumen[[i]])[colnames(lista_df_volumen[[i]]) == "PRINCIPADO DE ASTURIAS"] <- "ASTURIAS"
  colnames(lista_df_volumen[[i]])[colnames(lista_df_volumen[[i]]) == "C. FORAL DE NAVARRA"] <- "NAVARRA"
}

# Elimino las variables que ya no se utilizará.
rm(i)
```

Añado la variable Año, y le asigno a cada dataframe el año correspondiente.

```{r}
for (i in seq(1, 23)) {
  lista_df_volumen[[i]] <- lista_df_volumen[[i]] %>%
    mutate(AÑO = i + 1999)
}

rm(i)
```

Ordeno las variables de cada dataframe en orden alfabético

```{r}
for (i in seq(1, 23)){
  lista_df_volumen[[i]] <- lista_df_volumen[[i]] %>%
    select(sort(colnames(.)))
}

rm(i)
```

A continuación, compruebo que las categorias de alimentos seleccionadas se encuentran en todos los dataframe.

```{r}
categorias <- c("T.HUEVOS KGS", "MIEL", "TOTAL CARNE", "TOTAL PESCA",
                "TOTAL LECHE LIQUIDA", "TOTAL OTRAS LECHES",
                "PREPARADOS LACTEOS", "DERIVADOS LACTEOS", "PAN",
                "BOLL.PAST.GALLET.CERE", "CHOCOLATES/CACAOS/SUC", "ARROZ",
                "TOTAL PASTAS", "AZUCAR", "EDULCORANTES", "LEGUMBRES",
                "TOTAL ACEITE", "MARGARINA", "ACEITUNAS", "VINAGRE",
                "TOTAL ZUMO Y NECTAR", "TOTAL PATATAS", "T.HORTALIZAS FRESCAS",
                "T.FRUTAS FRESCAS", "FRUTOS SECOS", "T.FRUTA&HORTA.TRANSF",
                "PLATOS PREPARADOS", "CAFES E INFUSIONES", "CALDOS", "SALSAS",
                "AGUA DE BEBIDA ENVAS.", "HARINAS Y SEMOLAS", "ENCURTIDOS",
                "ESPECIAS Y CONDIMENTO", "SAL", "OTROS PROD.EN PESO",
                "OTROS PROD.EN VOLUMEN", "GASEOSAS Y BEBID.REFR",
                "BASES PIZZAS&MASAS HO", "ALGAS")


for (i in seq(1, 23)){
  cat("Nombre de la tabla de datos: df_volumen_", i+1999, "\n")
  alimentos_en_dataframe <- unique(lista_df_volumen[[i]]$CATEGORIAS)
  alimentos_faltantes <- setdiff(categorias, alimentos_en_dataframe)
  cat(alimentos_faltantes, "\n")
}

rm(i, alimentos_en_dataframe, alimentos_faltantes)
  
```
Como conclusión:

- En los dataframe de los años 2000 al 2018 faltan la categoría ALGAS

- En los dataframe de los años 2000 al 2007 la categoría T.HUEVOS KGS corresponde a HUEVOS KGS

- En los dataframe de los años 2000 al 2003 no existen las categorias: VINAGRE, HARINAS Y SEMOLAS, ENCURTIDOS, ESPECIAS Y CONDIMENTO, SAL y BASES PIZZAS&MASAS HO

- En el dataframe del 2004 faltan HARINAS Y SEMOLAS, ENCURTIDOS, ESPECIAS Y CONDIMENTO, SAL y BASES PIZZAS&MASAS HO

- En los dataframe de los años 2000 al 2006 la categoría AGUA DE BEBIDA ENVAS. corresponde a AGUA MINERAL y PREPARADOS LACTEOS corresponde a LECHE LIQUIDA RECONST

- En los dataframe de los años 2000 al 2003 la categoria .TOTAL ALIMENTACION corresponde a TOTAL ALIMENTACION

Corrijo el nombre de las categorias de alimentos erroneos

```{r}

for (i in seq(1, 23)){
  lista_df_volumen[[i]] <-lista_df_volumen[[i]] %>%
  mutate(CATEGORIAS = case_when(
    CATEGORIAS == "HUEVOS KGS" ~ "T.HUEVOS KGS",
    CATEGORIAS == "AGUA MINERAL" ~ "AGUA DE BEBIDA ENVAS.",
    CATEGORIAS == "LECHE LIQUIDA RECONST" ~ "PREPARADOS LACTEOS",
    CATEGORIAS == "BASES PIZZAS&MASAS HO" ~ "BASES PIZZAS Y MASAS HO",
    TRUE ~ CATEGORIAS))
}

rm(i, categorias)
```

Ahora, uno de forma vertical todos los dataframe en uno sólo que llamare df_volumen

```{r}
df_volumen <- bind_rows(lista_df_volumen)
```

Filtro df_volumen por las categorias de alimentos seleccionadas.

```{r}
categorias <- c("T.HUEVOS KGS", "MIEL", "TOTAL CARNE", "TOTAL PESCA",
                "TOTAL LECHE LIQUIDA", "TOTAL OTRAS LECHES",
                "PREPARADOS LACTEOS", "DERIVADOS LACTEOS", "PAN",
                "BOLL.PAST.GALLET.CERE", "CHOCOLATES/CACAOS/SUC", "ARROZ",
                "TOTAL PASTAS", "AZUCAR", "EDULCORANTES", "LEGUMBRES",
                "TOTAL ACEITE", "MARGARINA", "ACEITUNAS", "VINAGRE",
                "TOTAL ZUMO Y NECTAR", "TOTAL PATATAS", "T.HORTALIZAS FRESCAS",
                "T.FRUTAS FRESCAS", "FRUTOS SECOS", "T.FRUTA&HORTA.TRANSF",
                "PLATOS PREPARADOS", "CAFES E INFUSIONES", "CALDOS", "SALSAS",
                "AGUA DE BEBIDA ENVAS.", "HARINAS Y SEMOLAS", "ENCURTIDOS",
                "ESPECIAS Y CONDIMENTO", "SAL", "OTROS PROD.EN PESO",
                "OTROS PROD.EN VOLUMEN", "GASEOSAS Y BEBID.REFR",
                "BASES PIZZAS Y MASAS HO", "ALGAS")


df_volumen <- df_volumen %>%
  filter(CATEGORIAS %in% categorias)

rm(categorias)
```

Modifico el formato de df_volumen de formato ancho a largo

```{r}
df_volumen <- df_volumen %>%
  pivot_longer(cols = -c(CATEGORIAS, AÑO), 
               names_to = "REGIONES",
               values_to = "VOLUMEN")
```

Por último, modifico el forma df_volumen de formato largo a formato ancho de la variable Categoria

```{r}
df_volumen<- df_volumen %>%
  pivot_wider(
    names_from = CATEGORIAS,
    values_from = VOLUMEN
  )
```

### 2.4 Carga de los datos

Hago una copia de df_volumen llamada data, con la que trabajaré a continuación 

```{r}
data <- df_volumen

rm(lista_df_volumen)
```

## 3. Análisis descriptivo

En primer lugar, obtengo una vista descriptiva sobre el contenido del conjunto de datos, 

```{r}
print(head(data))
```
Examino la estructura interna del conjunto de los datos.

```{r}
str(data)
```
Ahora, obtengo un resumen estadísito de cada una de las variables.

```{r}
summary(data)
```

Acontinuación realizo un histograma por cada variable numérica, a excepción de AÑO, para ver como se distribuyen sus datos.

```{r}
par(mfrow = c(2, 3))

options(scipen = 100)

for (i in seq(3, 42)) {
  nombre_variable <- colnames(data)[i]
  hist(
    x = data[[i]],
    main = nombre_variable,
    xlab = "Valores",
    ylab = "Frecuencia",
    breaks = 100
  )
}

rm(i, nombre_variable)

```

Según los resultados obetenidos, las principales caracteristicas del conjunto de datos son los siguientes:

- El número total de observaciones del conjunto de datos es de 414.
  
- El número total de variables son 42, de las cuales, una de tipo cadena de caracteres y las 40 restantes numéricas.
  
- El rango temporal abarca desde el año 2000 hata el 2022.

- Observando los histográmas de las 39 variables numéricas, podemos concluir que todas presentan una distribución sesgada hacia la izquierda, es decir, la mayoría de los valores de cada variable se situan a la izquierda.

## 4. Ajuste de variables

De todas las variables del conjunto de datos, es importante detenerse en dos, AÑO y REGIONES a la hora de determinar el tipo de variable.

La variable AÑO, como su propio nombre indica, se refiere al año de los datos. Al referirse a una fecha podría ser util modificar el tipo de dato a fecha. Sin embargo, la mantendré como númerica, ya que, si fuera necesario, me permitirá realizar operaciones matemáticas.

```{r}
print(unique(data$REGIONES))
```

La variable REGIONES hace referencia al ambito geográfica de los datos. Esta variable contiene 18 regiones, esto es, cada Comunidad Autónoma más España. Por lo tanto, como se ha indicado anteriromente, esta variable es una variable categórica con lo que la transformare a factor. 

```{r}
data$REGIONES <- as.factor(data$REGIONES)
```

## 5. Detección y tratamiento de datos ausentes

Calculo el número de valores ausentes totales del conjunto de datos

```{r}
sum(is.na(data))
```

Ahora, calculo el porcentaje de valores perdidos con respecto al total de los registros del conjunto de los datos

```{r}
mean(is.na(data))
```

Calculo el número de valores ausentes por variables

```{r}
colSums(is.na(data))
```
Y, por últmo, hayo el porcentaje de los valores ausentes por variable

```{r}
colMeans(is.na(data), na.rm = TRUE)
```

Despues de analizar estos datos, la conclusión es la siguiente:

- El conjunto de datos contiene 864 valores ausentes, que supone el 4.85% del total de los datos.

- Las variables que contienen datos ausentes son: VINAGRE, BASES_PIZZAS_Y_MASAS_HO, HARINAS_Y_SEMOLAS, ENCURTIDOS, ALGAS, SAL, ESPECIAS_Y_CONDIMENTO.

- La variable VINAGRE tiene 72 valores ausentes que supone un 17.39% de los datos.

- La variable ALGAS tiene 342 valores ausentes que suponen un 82.6%  de los datos

- El resto de las variables tienen 90 valores ausentes cada una, que suponen un 21.73% de los datos ausentes de las mismas.


En este proyecto descriptivo de análisis de datos, hemos elegido no realizar la imputación de valores faltantes en nuestras variables. La razón principal detrás de estos valores faltantes se debe a un cambio en la metodología de recopilación y registro de datos en un momento específico durante el período estudiado. Aunque la cantidad de valores faltantes en otras variables es relativamente baja, representando un 4.85% del total, no anticipamos que tengan un impacto significativo en la calidad o representatividad de nuestras conclusiones. Esta decisión simplifica nuestro enfoque analítico, permitiéndonos centrarnos en comprender y presentar la información disponible de manera transparente. Creemos que esta elección es coherente con los objetivos de nuestro proyecto y contribuye a una interpretación más nítida y directa de nuestros hallazgos descriptivos.

## 6. Identificación de datos atípicos

En primer lugar, identifico los valores atípicos de las variables continuas mediante un gráfico boxplot

```{r}

par(mfrow = c(2, 3))

# Crear gráficos de caja para variables numéricas
for (i in seq(3, 42)) {
  nombre_variable <- colnames(data)[i]
  datos_variable <- data[[i]]
  
  # Eliminar valores faltantes
  datos_variable <- datos_variable[!is.na(datos_variable)]
  
  # Calcular estadísticas del boxplot
  stats <- boxplot.stats(datos_variable)
  
  # Crear el gráfico de caja
  boxplot(
    datos_variable,
    horizontal = TRUE,
    main = nombre_variable)
}

rm(nombre_variable, i,  datos_variable, stats)
```

A continuación, identifico los valores atípicos de las variables REGIONES y AÑO.

```{r}
# Crear un histograma de la variable "AÑO"
hist(data$AÑO, 
     main = "Histograma de AÑO",
     xlab = "AÑO",
     ylab = "Frecuencia",
     col = "blue",
     breaks = seq(min(data$AÑO) - 0.5, max(data$AÑO) + 0.5, by = 1),
     xlim = c(2000, 2025), # Ajustar límites del eje x
     ylim = c(0, 20)) # Ajustar límites del eje y
```

```{r}
# Crear un gráfico de barras para la variable "REGIONES" con etiquetas personalizadas
barplot(table(data$REGIONES), 
        main = "Histográma de REGIONES",
        ylab = "Frecuencia",
        col = "blue",
        border = "black",
        las = 2,  # Rotar etiquetas en el eje x
        cex.names = 0.5,  # Tamaño de las etiquetas de las regiones
        xlim = c(0, length(unique(data$REGIONES)) + 3), # Ajustar límites del eje x
        ylim = c(0, 25)) # Ajustar límites del eje y
```

Una vez examinadas las gráficas, las conclusiones son las siguientes:

- Todas las variables continuas, que hacen referencia a categorias de aliemntos, contiene valores atípicos. Esto era de esperar, segun el analisis de los histográmas realizados en la fase de Exploración inicial de los datos. Estos valores atípicos puede deberse a que el volumen de alimentos que consume los hogares españoles de unas regiones, como España, Madrid, Andalucia o Cataluña, sean muy superiores a otras regiones con menos población. 

- En cuanto a las variables AÑO y REGIONES, como era de esperar, cada valor se ve que se repiten las mismas cantidad de veces veces.

## 7. Análisis de correlación entre las variables

A continuación, mediante una matriz de correlación analizo la relación entre las variables numéricas.

```{r}
# Seleccionar las variables numéricas
indice <- seq(3, 42, 1)
num_variable <- data[, indice]

# Calcular la matriz de correlación
correlacion <- cor(num_variable, use = "pairwise.complete.obs") # Ignorar valores faltantes

# Cargar la librería corrplot si aún no está cargada
# install.packages("corrplot") # Instala la librería si es necesario
# library(corrplot)

# Visualizar la matriz de correlación
corrplot(
  correlacion,
  method = "square",
  tl.cex = 0.3, # Tamaño de la fuente en las etiquetas
  diag = FALSE, # No mostrar correlaciones en la diagonal
  tl.col = "black" # Color de las etiquetas
)

rm(indice, num_variable, correlacion)
```

Como regla general se puede afirmar que todas las categorias de alimentos mantienen cierta relación lineal positiva entre sí. Sin embargo, existen algunas variables cuya correlación es más devil. 

- OTROS PROD.EN PESO es la variable que relación mantiene con el resto de las variables, a excepción de BASES PIZZAS Y MASAS Ho, HARINAS Y SEMOLAS, ENCURTIDOS, ESPECIAS Y CONDIMENTPS y SAL cuya relación es más fuerte.

- ALGAS tiene una relación más devil con todas las variables. 

- PREPARADOS LACTEOS, EDULCORANTES, PLATOS PREPARADOS parece que tienen una relación más devil con el resto de variables. 

## 8. Conclusiones

Los datos que he analizado corresponden al volumen de alimentos consumidos por los hogares españoles en el período de 2000 a 2022. Estos datos se encuentran almacenados en la hoja "VOLUMEN" de 22 archivos Excel, uno para cada año, y están disponibles en un repositorio de GitHub.

Tras la preparación del entorno de trabajo y la extracción de los datos, realicé una exploración inicial que proporcionó las siguientes conclusiones:

- Se observa una disparidad en la cantidad de registros, es decir, en la variedad de alimentos, entre los distintos dataframes.

- Algunos dataframes contienen 19 variables, mientras que otros presentan 27. Esta diferencia se debe a que, a partir de 2004, se incorporaron 8 regiones adicionales para la recopilación de datos.

- Existe variabilidad en los nombres de las variables en algunos dataframes.

- Es posible que los nombres de los alimentos varíen entre los distintos dataframes.

Ante esta disparidad en el número de alimentos registrados a lo largo de los años debido a cambios en la metodología, y considerando el estado inicial del proyecto, opté por realizar una selección de registros. En esta selección, prioricé las categorías de alimentos que representan las principales agrupaciones alimentarias. Esta metodología simplifica la complejidad de los datos, aunque implica la pérdida de algunos detalles específicos sobre los alimentos. Como resultado, los análisis se centrarán en identificar tendencias generales en lugar de profundizar en detalles individuales de cada alimento.

Además, decidí reducir el número de variables, conservando solo aquellas que corresponden a España y las Comunidades Autónomas. El conjunto de datos resultante consta de 414 observaciones y 42 variables:

- De las 42 variables, 41 son numéricas y se refieren a categorías de alimentos y al año en el que se recopilaron los datos. Hay una variable categórica que representa las diferentes regiones.

- El rango temporal abarca desde 2000 hasta 2022.

- Desde una perspectiva geográfica, los datos se refieren al consumo de alimentos por parte de los hogares en España y cada Comunidad Autónoma.

- El conjunto de datos presenta 864 valores ausentes, equivalentes al 4.96% del total de los valores. Las variables con valores ausentes son:

  - "VINAGRE" con 72 valores ausentes (17.39% de los datos) debido a que esta variable no se registró hasta 2004.
  
  - "BASES_PIZZAS_Y_MASAS_HO," "HARINAS Y SEMOLAS," "ENCURTIDOS," "ESPECIAS Y CONDIMENTO," y "SAL" con 90 valores ausentes cada una (21.73% de los datos) porque no se registraron hasta 2005.
  
  - "ALGAS" con 342 valores ausentes (82.60% de los datos) ya que solo se comenzó a registrar a partir de 2019.

Todas las variables numéricas relacionadas con categorías de alimentos presentan valores atípicos. Esto se debe a que el consumo de alimentos varía significativamente entre regiones con diferentes poblaciones. Por ejemplo, el consumo de alimentos en España y en Comunidades Autónomas densamente pobladas como Madrid, Cataluña y Andalucía es más alto en comparación con regiones menos pobladas como La Rioja o Murcia.

Finalmente, se observa que todas las variables numéricas muestran una fuerte correlación entre sí, con la excepción de "ALGAS" y "OTROS PROD.EN PESO," que parecen tener una relación más débil con el resto de las variables, especialmente "OTROS PROD.EN PESO."

Dado que la ausencia de datos se debe a un cambio en la metodología de recopilación y teniendo en cuenta que uno de los objetivos del proyecto es realizar un análisis descriptivo, se decidió no realizar un tratamiento especial de los valores ausentes. Esto permitirá que las conclusiones finales reflejen esta ausencia y consideren la posibilidad de abordarla en futuros proyectos. 

Lo mismo cabe decir de los valores atípicos, que no he realizado ningún tratamiento ya que, entiendo que son normales que existan.

En resumen, este análisis exploratorio de datos proporciona una base sólida para futuras investigaciones y proyectos relacionados con el consumo de alimentos en hogares españoles. Se ha destacado la necesidad de considerar cuidadosamente la variabilidad y los cambios en los datos a lo largo del tiempo al realizar análisis comparativos. Además, se ha enfatizado la importancia de mantener registros de valores ausentes y considerar posibles enfoques para su tratamiento en análisis futuros.